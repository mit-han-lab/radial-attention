diff --git a/setup.py b/setup.py
index 5e8e4e4..31e6254 100644
--- a/setup.py
+++ b/setup.py
@@ -48,7 +48,7 @@ def get_instantiations(src_dir: str):
     ]

 # Supported NVIDIA GPU architectures.
-SUPPORTED_ARCHS = {"8.0", "8.6", "8.7", "8.9", "9.0"}
+SUPPORTED_ARCHS = {"8.0", "8.6", "8.7", "8.9", "9.0", "12.0"}

 # Compiler flags.
 CXX_FLAGS = ["-g", "-O3", "-fopenmp", "-lgomp", "-std=c++17", "-DENABLE_BF16"]
@@ -147,11 +147,18 @@ if nvcc_cuda_version < Version("12.4"):

 # Add target compute capabilities to NVCC flags.
 for capability in compute_capabilities:
-    num = capability[0] + capability[2]
+    # num = capability[0] + capability[2] # ori
+    # replace
+    want_ptx = capability.endswith("+PTX")
+    base = capability.replace("+PTX", "")
+    #  try "12.0" -> "120"
+    num = base.replace(".", "")
+
     if num == '90':
         num = '90a'
         HAS_SM90 = True
         CXX_FLAGS += ["-DHAS_SM90"]
+
     NVCC_FLAGS += ["-gencode", f"arch=compute_{num},code=sm_{num}"]
     if capability.endswith("+PTX"):
         NVCC_FLAGS += ["-gencode", f"arch=compute_{num},code=compute_{num}"]
@@ -179,7 +186,7 @@ qattn_extension = CUDAExtension(
         "cxx": CXX_FLAGS,
         "nvcc": NVCC_FLAGS,
     },
-    extra_link_args=['-lcuda'],
+    extra_link_args=['-lcudart'],
 )
 ext_modules.append(qattn_extension)

